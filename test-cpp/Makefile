
BUILD_DIR := build
EXEC      := test.exe


CXX       := g++
CPPFLAGS  := -std=c++14 -O3 -Wall -MMD
LDFLAGS   := 

# Files
SRCS := $(wildcard *.cpp)
OBJS := $(SRCS:%.cpp=$(BUILD_DIR)/%.o)
DEPS      := $(OBJS:$.o=$.d)

# General targets
all: $(BUILD_DIR)/$(EXEC)

clean:
	rm -rf $(BUILD_DIR)

# Specific targets
$(BUILD_DIR)/$(EXEC): $(BUILD_DIR) $(OBJS)
	$(CXX) $(OBJS) -o $@ $(LDFLAGS)

$(BUILD_DIR)/%.o: %.cpp
	$(CXX) -c $(CPPFLAGS) -o $@ $<

$(BUILD_DIR):
	mkdir -p $@

# include all .d files generated by g++ because of the -MMD flag
-include $(DEPS)

.PHONY: all clean